{% extends "base.html" %}

{% block content %}
  <h2>案件列表</h2>

  <form method="GET" action="{% url 'case_list' %}">
    <input type="text" name="q" value="{{ query }}" placeholder="輸入搜尋關鍵字">
	
    <label for="sort_order">排序方式：</label>
    <select name="sort_order" id="sort_order">
        <option value="-created_at" {% if sort_order == "-created_at" %}selected{% endif %}>最新優先</option>
        <option value="created_at" {% if sort_order == "created_at" %}selected{% endif %}>最舊優先</option>
    </select>	
	
    <button type="submit">搜尋</button>
  </form>

  {% if user.is_authenticated %}
    <a href="{% url 'add_case' %}">新增案件</a>
  {% endif %}

  <ul>
    {% for case in cases %}
      <li>
        <a href="{% url 'case_detail' case.id %}"><strong>案件號碼：</strong> {{ case.case_number }}</a><br>
        <strong>部門：</strong> {{ case.department }}<br>
        <strong>狀態：</strong> {{ case.status }}<br>
		<strong>建立日期：</strong> {{ case.created_at|date:"Y-m-d H:i" }}  <!-- 🔹 顯示日期 -->
        <br>
        {% if user.is_authenticated %}
          <a href="{% url 'edit_case' case.id %}">編輯</a>
        {% endif %}
      </li>
      <hr>
	{% empty %}
      <p>沒有符合條件的案件</p>
    {% endfor %}
  </ul>
{% endblock %}
